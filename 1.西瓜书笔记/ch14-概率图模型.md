# 第十四章 概率图模型

## 14.1 先修知识
- 概率图模型（Probabilistic Graphical Model，PGM）
  - 概率图模型（Probabilistic Graphical Model，PGM）是一种用于建模概率关系的图结构模型。**它能够表示变量之间的依赖关系**，并且使用概率分布来描述这些依赖关系。
  - 概率图模型主要有两种类型：**贝叶斯网络（Bayesian Network）和马尔可夫随机场（Markov Random Field）。**
    1. **贝叶斯网络（Bayesian Network，也称为有向图模型）：贝叶斯网络使用有向无环图（DAG）表示变量之间的依赖关系**。节点表示随机变量，边表示变量之间的条件依赖关系。每个节点都与一个条件概率表相关联，该表描述了给定其父节点的取值时，该节点的取值的概率分布。**贝叶斯网络可以用来进行因果推断和概率推理**，常用于处理不确定性推理和决策问题。
    2. **马尔可夫随机场（Markov Random Field，也称为无向图模型）：马尔可夫随机场使用无向图表示变量之间的依赖关系**。图中的节点表示随机变量，边表示变量之间的相关性。每个节点与一个势函数（或能量函数）相关联，该函数度量了该节点与其邻居节点的关系。马尔可夫随机场主要用于建模联合概率分布，可以用于图像分割、图像处理、计算机视觉等领域。
  概率图模型具有许多优点，包括清晰的可视化表示、模型的简洁性和模块化性质。它们提供了一种灵活的框架，用于对复杂的概率关系建模和推理。概率图模型在机器学习、人工智能、统计学和模式识别等领域中被广泛应用，包括决策网络、隐马尔可夫模型和条件随机场等。

- 隐马尔可夫模型（Hidden Markov Model，HMM）
  - 隐马尔可夫模型（Hidden Markov Model，HMM）是一种用于**建模序列数据**的统计模型。它是马尔可夫模型的扩展，**适用于存在状态（观察不到）和观察（可见）之间的关系的问题。**
  - **HMM由两个基本要素组成：状态和观察**。状态是隐藏的，表示系统内部的一种特定状态；观察是可见的，表示我们能够观测到的数据。在HMM中，系统在不同的状态之间转换，并且每个状态生成特定的观察。
  - **HMM由以下几个部分组成**：
    1. 状态集合（State set）：包含系统可能的状态。记为S={$s_1, s_2, ..., s_n$}。
    2. 观察集合（Observation set）：包含可以观察到的数据。记为O={$o_1, o_2, ..., o_m$}。
    3. 状态转移概率矩阵（Transition probability matrix）：表示状态之间的转换概率。记为A={$a_{ij}$}，其中{$a_{ij}$}表示从状态$s_i$转移到状态$s_j$的概率。
    4. 观察概率矩阵（Observation probability matrix）：表示在给定状态下生成观察的概率。记为B={$b_{ij}$}，其中B={$b_{ij}$}表示在状态$s_i$生成观察$o_j$的概率。
    5. 初始状态概率向量（Initial state probability vector）：表示系统初始状态的概率分布。记为π={$π_i$}，其中$π_i$表示系统初始状态为$s_i$的概率。
  - **HMM有三个基本问题**：
    1. 评估问题（Evaluation problem）：给定模型λ=(A, B, π)和观察序列O，计算给定观察序列的概率P(O|λ)。
    2. 解码问题（Decoding problem）：给定模型λ=(A, B, π)和观察序列O，找到最可能的对应状态序列。
    3. 学习问题（Learning problem）：给定观察序列O，估计模型λ=(A, B, π)的参数。
  - HMM的应用非常广泛，特别适用于语音识别、自然语言处理、生物信息学和时间序列分析等领域。通过对状态和观察之间的关系进行建模，HMM可以用来预测未来的状态，进行序列标注和分类，以及进行序列生成等任务。

- 马尔可夫随机场（Markov Random Field，MRF）
  - **马尔可夫随机场（Markov Random Field，MRF）是一种用于建模联合概率分布的无向图模型**。它描述了一组变量之间的相关性，并且基于马尔可夫性质，即给定一个变量集合的条件下，**每个变量只依赖于其邻居节点的取值**。
  - MRF由一个无向图表示，图中的节点表示随机变量，边表示变量之间的相关性。**与有向图模型（如贝叶斯网络）不同，MRF没有明确的因果关系，变量之间的依赖关系是对称的**。
  - MRF中的变量可以分为两类：
    1. 可见变量（Observable Variables）：表示我们能够直接观察到的变量。
    2. 隐藏变量（Hidden Variables）：表示我们无法直接观察到的变量。
  - **MRF使用势函数（Potential Function）来度量变量之间的相关性**。势函数定义在**图中的团（Clique）上，一个团是指图中完全连接的一组节点**。势函数通常表示为指数函数的形式，其中指数的值与团的配置相关。
  - MRF的联合概率分布可以通过对势函数的归一化常数进行标准化来计算。给定MRF的势函数和变量的取值，可以计算出整个网络的联合概率分布。
  - MRF可以用于许多任务，包括图像处理、计算机视觉、模式识别和统计推断等。例如，在图像处理中，MRF被广泛用于图像分割、图像去噪和图像恢复等任务，其中变量通常表示图像的像素或区域。
  - **对于MRF，推断问题是一个重要的任务**，包括计算变量的边缘概率、最大后验概率估计和找到具有最高概率的变量配置。**常用的推断算法包括信念传播（Belief Propagation）、Gibbs采样和变分推断等**。
  - 总而言之，马尔可夫随机场是一种强大的概率图模型，能够用于建模变量之间的相关性。它具有广泛的应用领域，并在许多机器学习和人工智能任务中发挥重要作用。

---------------------------------------------------
1. 概率模型（probabilistic model）提供了一种描述框架，将学习任务归结于计算变量的概率分布。**在概率模型中，利用已知变量推测未知变量的分布称为“推断”（inference）**，其核心是如何基于可观测变量推测出未知变量的**条件分布**。**直接利用概率求和规则消去变量R显然不可行，因为即便每个变量仅有两种取值的简单问题，其复杂度已至少是$O(2^{|Y|+|R|})$.
2. 概率图模型（probabilistic graphical model）是一类用图来表达变量相关关系的概率模型。它以图为表示工具，最常见的是用一个结点表示一个或一组随机变量，节点之间的边表示变量间的概率相关关系，即“变量关系图”
3. 根据边的性质不同，概率图模型可大致分为两类：
   1. 使用**有向无环图**表示变量间的**依赖关系**，称为**有向图模型或贝叶斯网（Bayesian netword）**
   2. 使用**无向图**表示变量间的**相关关系**，称为**无向图模型或马尔可夫网（Markov network）**
4. **隐马尔可夫模型（Hidden Markov Model，简称HMM）是结构最简单的动态贝叶斯网（dynamic Bayesian network），这是一种著名的有向图模型，主要用于时序数据建模**
5. **隐马尔可夫用到了所谓的“马尔科夫链”（Markov chain），即：系统下一时刻的状态仅由当前状态决定，不依赖于以往的任何状态**
6. 隐马尔可夫模型的三个基本问题：
![20230614100417](https://cdn.jsdelivr.net/gh/Corner430/Picture1/images/20230614100417.png)
> 值得庆幸的是，基于条件独立性，隐马尔可夫模型的这三个问题均能被高效求解

7. 马尔可夫随机场（Markov Random Field，MRF）是典型的马尔可夫网，这是一种著名的**无向图模型**。图中每个结点表示一个或一组变量，节点之间的边表示两个变量之间的**依赖关系**。马尔可夫随机场有一组**势函数（potential functions），亦称“因子”（factor），这是定义在变量子集上的非负实函数，主要用于定义概分布函数**.对于图中结点的一个子集，**若其中任意两结点间都有边连接，则称该结点子集为一个“团”（clique）**.若在一个团中加入另外任何一个结点都不再形成团，则称该团为“极大团”（maximal clique）；**换言之，极大团就是不能被其他团所包含的团**。

TODO

